<!-- API Test Card - Front Template -->
<style>
body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
.section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 8px; }
.section h3 { margin-top: 0; color: #4a90e2; }
button { margin: 5px; padding: 8px 12px; cursor: pointer; border-radius: 4px; border: 1px solid #4a90e2; background: white; }
button:hover { background: #e6f2ff; }
.output { margin-top: 10px; padding: 10px; background: #f5f5f5; border-radius: 4px; font-family: monospace; font-size: 12px; max-height: 200px; overflow-y: auto; }
.success { color: green; }
.error { color: red; }
@media (prefers-color-scheme: dark) {
    body { background: #1a1a1a; color: #e0e0e0; }
    .section { border-color: #444; background: #2a2a2a; }
    button { background: #333; color: #e0e0e0; border-color: #555; }
    button:hover { background: #444; }
    .output { background: #1e1e1e; color: #d0d0d0; }
}
</style>

<div style="text-align: center; margin-bottom: 30px;">
    <h1>AnkiDroid JS API Test Card</h1>
    <p>Front Side - Click buttons to test each API</p>
</div>

<!-- API Initialization -->
<script>
var jsApiContract = { version: "0.0.3", developer: "test@example.com" };
try { window.api = new AnkiDroidJS(jsApiContract); } catch (e) { window.api = null; }

function log(section, message, isError) {
    const output = document.getElementById(section + '-output');
    const div = document.createElement('div');
    div.className = isError ? 'error' : 'success';
    div.textContent = new Date().toLocaleTimeString() + ': ' + message;
    output.appendChild(div);
    output.scrollTop = output.scrollHeight;
}

function testApi(section, apiName, apiCall) {
    log(section, 'Testing ' + apiName + '...');
    try {
        const result = apiCall();
        if (result && typeof result.then === 'function') {
            result.then(function(res) {
                log(section, apiName + ' → ' + JSON.stringify(res));
            }).catch(function(err) {
                log(section, apiName + ' ERROR: ' + err.message, true);
            });
        } else {
            log(section, apiName + ' → ' + JSON.stringify(result));
        }
    } catch (e) {
        log(section, apiName + ' ERROR: ' + e.message, true);
    }
}
</script>

<!-- Card Information APIs -->
<div class="section">
    <h3>Card Information</h3>
    <button onclick="testApi('card-info', 'ankiGetNewCardCount', () => api.ankiGetNewCardCount())">New Count</button>
    <button onclick="testApi('card-info', 'ankiGetLrnCardCount', () => api.ankiGetLrnCardCount())">Learn Count</button>
    <button onclick="testApi('card-info', 'ankiGetRevCardCount', () => api.ankiGetRevCardCount())">Review Count</button>
    <button onclick="testApi('card-info', 'ankiGetETA', () => api.ankiGetETA())">ETA</button>
    <button onclick="testApi('card-info', 'ankiGetCardMark', () => api.ankiGetCardMark())">Card Mark</button>
    <button onclick="testApi('card-info', 'ankiGetCardFlag', () => api.ankiGetCardFlag())">Card Flag</button>
    <button onclick="testApi('card-info', 'ankiGetCardLeft', () => api.ankiGetCardLeft())">Cards Left</button>
    <button onclick="testApi('card-info', 'ankiGetCardReps', () => api.ankiGetCardReps())">Reps</button>
    <button onclick="testApi('card-info', 'ankiGetCardInterval', () => api.ankiGetCardInterval())">Interval</button>
    <button onclick="testApi('card-info', 'ankiGetCardFactor', () => api.ankiGetCardFactor())">Ease</button>
    <button onclick="testApi('card-info', 'ankiGetCardMod', () => api.ankiGetCardMod())">Modified</button>
    <button onclick="testApi('card-info', 'ankiGetCardId', () => api.ankiGetCardId())">Card ID</button>
    <button onclick="testApi('card-info', 'ankiGetCardNid', () => api.ankiGetCardNid())">Note ID</button>
    <button onclick="testApi('card-info', 'ankiGetCardType', () => api.ankiGetCardType())">Type</button>
    <button onclick="testApi('card-info', 'ankiGetCardDid', () => api.ankiGetCardDid())">Deck ID</button>
    <button onclick="testApi('card-info', 'ankiGetCardQueue', () => api.ankiGetCardQueue())">Queue</button>
    <button onclick="testApi('card-info', 'ankiGetCardLapses', () => api.ankiGetCardLapses())">Lapses</button>
    <button onclick="testApi('card-info', 'ankiGetCardDue', () => api.ankiGetCardDue())">Due</button>
    <button onclick="testApi('card-info', 'ankiGetDeckName', () => api.ankiGetDeckName())">Deck Name</button>
    <button onclick="testApi('card-info', 'ankiGetNextTime1', () => api.ankiGetNextTime1())">Next Time 1</button>
    <button onclick="testApi('card-info', 'ankiGetNextTime2', () => api.ankiGetNextTime2())">Next Time 2</button>
    <button onclick="testApi('card-info', 'ankiGetNextTime3', () => api.ankiGetNextTime3())">Next Time 3</button>
    <button onclick="testApi('card-info', 'ankiGetNextTime4', () => api.ankiGetNextTime4())">Next Time 4</button>
    <div id="card-info-output" class="output"></div>
</div>

<!-- Card Actions -->
<div class="section">
    <h3>Card Actions</h3>
    <button onclick="testApi('card-actions', 'ankiMarkCard', () => api.ankiMarkCard())">Toggle Mark</button>
    <button onclick="testApi('card-actions', 'ankiToggleFlag(red)', () => api.ankiToggleFlag('red'))">Toggle Red Flag</button>
    <button onclick="testApi('card-actions', 'ankiToggleFlag(blue)', () => api.ankiToggleFlag('blue'))">Toggle Blue Flag</button>
    <button onclick="testApi('card-actions', 'ankiSearchCard', () => api.ankiSearchCard('deck:current'))">Search Card</button>
    <div id="card-actions-output" class="output"></div>
    <p style="color: #666; font-size: 12px;">⚠️ Dangerous: Bury, Suspend, Reset - Test with caution!</p>
</div>

<!-- Reviewer Control -->
<div class="section">
    <h3>Reviewer Control</h3>
    <button onclick="testApi('reviewer', 'ankiIsDisplayingAnswer', () => api.ankiIsDisplayingAnswer())">Is Answer?</button>
    <button onclick="testApi('reviewer', 'ankiShowAnswer', () => api.ankiShowAnswer())">Show Answer</button>
    <button onclick="testApi('reviewer', 'ankiGetDebugInfo', () => api.ankiGetDebugInfo())">Debug Info</button>
    <div id="reviewer-output" class="output"></div>
</div>

<!-- TTS Control -->
<div class="section">
    <h3>TTS (Text-to-Speech)</h3>
    <button onclick="testApi('tts', 'ankiTtsSpeak(Hello)', () => api.ankiTtsSpeak('Hello, this is a test.'))">Speak English</button>
    <button onclick="testApi('tts', 'ankiTtsSpeak(こんにちは)', () => api.ankiTtsSpeak('こんにちは、これはテストです。'))">Speak Japanese</button>
    <button onclick="testApi('tts', 'ankiTtsSetLanguage(ja)', () => api.ankiTtsSetLanguage('ja'))">Set Japanese</button>
    <button onclick="testApi('tts', 'ankiTtsSetLanguage(en)', () => api.ankiTtsSetLanguage('en-US'))">Set English</button>
    <button onclick="testApi('tts', 'ankiTtsSetPitch(1.2)', () => api.ankiTtsSetPitch(1.2))">Set Pitch 1.2</button>
    <button onclick="testApi('tts', 'ankiTtsSetSpeechRate(0.8)', () => api.ankiTtsSetSpeechRate(0.8))">Set Rate 0.8</button>
    <button onclick="testApi('tts', 'ankiTtsIsSpeaking', () => api.ankiTtsIsSpeaking())">Is Speaking?</button>
    <button onclick="testApi('tts', 'ankiTtsStop', () => api.ankiTtsStop())">Stop</button>
    <div id="tts-output" class="output"></div>
</div>

<!-- UI Control -->
<div class="section">
    <h3>UI Control</h3>
    <button onclick="testApi('ui', 'ankiIsInFullscreen', () => api.ankiIsInFullscreen())">Is Fullscreen?</button>
    <button onclick="testApi('ui', 'ankiIsTopbarShown', () => api.ankiIsTopbarShown())">Is Topbar Shown?</button>
    <button onclick="testApi('ui', 'ankiIsInNightMode', () => api.ankiIsInNightMode())">Is Night Mode?</button>
    <button onclick="testApi('ui', 'ankiShowToast', () => api.ankiShowToast('Test Toast Message!'))">Show Toast</button>
    <div id="ui-output" class="output"></div>
</div>

<!-- Tag Management -->
<div class="section">
    <h3>Tag Management</h3>
    <button onclick="testApi('tags', 'ankiGetNoteTags', () => api.ankiGetNoteTags())">Get Tags</button>
    <button onclick="testApi('tags', 'ankiAddTagToNote(test)', () => api.ankiAddTagToNote('test-tag'))">Add Tag</button>
    <div id="tags-output" class="output"></div>
</div>

<!-- Utility -->
<div class="section">
    <h3>Utility</h3>
    <button onclick="testApi('util', 'ankiIsActiveNetworkMetered', () => api.ankiIsActiveNetworkMetered())">Is Metered?</button>
    <div id="util-output" class="output"></div>
</div>

<!-- Global Functions Test -->
<div class="section">
    <h3>Global Functions (Template Compatibility)</h3>
    <button onclick="testApi('global', 'showAnswer', () => { showAnswer(); return 'Called'; })">showAnswer()</button>
    <button onclick="testApi('global', 'buttonAnswerEase1', () => buttonAnswerEase1())">buttonAnswerEase1()</button>
    <button onclick="testApi('global', 'buttonAnswerEase2', () => buttonAnswerEase2())">buttonAnswerEase2()</button>
    <button onclick="testApi('global', 'buttonAnswerEase3', () => buttonAnswerEase3())">buttonAnswerEase3()</button>
    <button onclick="testApi('global', 'buttonAnswerEase4', () => buttonAnswerEase4())">buttonAnswerEase4()</button>
    <div id="global-output" class="output"></div>
    <p style="color: #666; font-size: 12px;">⚠️ Note: buttonAnswerEase will only work on answer side</p>
</div>

<div style="text-align: center; margin-top: 30px;">
    <button onclick="showAnswer()" style="font-size: 18px; padding: 12px 24px; background: #4a90e2; color: white; border: none;">
        Show Answer Side →
    </button>
</div>

{{Front}}
